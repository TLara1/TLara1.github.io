<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Celestial Mechanics and the Precession of Mercury | Teo A. Lara </title> <meta name="author" content="Teo A. Lara"> <meta name="description" content=""> <meta name="keywords" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tlara1.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Teo A. Lara </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/Publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Notes <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item active"> <a class="nav-link" href="/_pages/dropdown.html">Other Interests </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Celestial Mechanics and the Precession of Mercury</h1> <p class="post-description"></p> </header> <article> <h2>I. Mechanics</h2> <h3>I.I Canonical Transforms</h3> <p>A time-independent coordinate transform \(q_i\rightarrow Q_i\) and \(p_i\rightarrow P_i\) is said to be canonical if it preserves Hamilton’s equations of motion. Specifically, letting the new Hamiltonian \(\mathcal{K}\left(Q_i,P_i\right)=\mathcal{H}\left(q\left(Q_i,P_i\right),p_i\left(Q_i,P_i\right)\right)\), then we have:</p> <p>\begin{equation} \dot{Q}_i=\frac{\partial\mathcal{K}}{\partial P_i} \end{equation}</p> <p>\begin{equation} \dot{P}_i=-\frac{\partial\mathcal{K}}{\partial Q_i} \end{equation}</p> <p>The most useful criteria for determining if a transform is canonical are <em>Poisson brackets</em>. Given coordinates \(q_i\) and \(p_i\), the Poisson bracket of functions \(Q_j\left(q_i,p_i\right)\) and \(P_j\left(q_i,p_i\right)\) is given by: \begin{equation} [ Q_j,P_j ]=\sum_i\frac{\partial Q_j}{\partial q_i}\frac{\partial P_j}{\partial p_i}-\frac{\partial Q_j}{\partial p_i}\frac{\partial P_j}{\partial q_i} \end{equation} We show that a transform is canonical if and only if:</p> <p>\begin{equation} [ Q_i,Q_j ]=0\label{cannonical 1} \end{equation}</p> <p>\begin{equation} [ P_i,P_j ]=0 \end{equation}</p> <p>\begin{equation} [ Q_i,P_j ]=\delta_{ij}\label{cannonical 3} \end{equation}</p> <p>Poisson Brackets can also be used to determine if a function of coordinates \(f\left(p_i,q_i\right)\) is constant in time: \begin{equation}\label{const function} \frac{df}{dt}=\sum_i\frac{\partial f}{\partial q_i}\dot{q}_i+\frac{\partial f}{\partial p_i}\dot{p}_i=[ f,\mathcal{H} ] \end{equation}</p> <h3>I.II The Hamilton-Jacobi Equation</h3> <p>A generating function \(F\) generates a canonical transformation from coordinates \(q_i\rightarrow Q_i\) and \(p_i\rightarrow P_i\) and a Hamiltonian \(\mathcal{H\rightarrow\mathcal{K}}\). This generating function satisfies: \begin{equation} p_i\dot{q}_i-\mathcal{H}=P_i\dot{Q}_i-\mathcal{K}+\dot{F} \end{equation} Letting \(F=S\left(q_i,P_i,t\right)-Q_iP_i\), we have: \begin{equation} Q_i=\frac{\partial S}{\partial P_i}\label{transormned position coordinates} \end{equation}</p> <p>\begin{equation} p_i=\frac{\partial S}{\partial q_i} \end{equation}</p> <p>\begin{equation} \mathcal{K}=\mathcal{H}+\frac{\partial S}{\partial t} \end{equation} Now, suppose we want our transformed Hamiltonian, \(\mathcal{K}=0\) such that \(\dot{Q}_i=0\) and \(\dot{P}_i=0\). So, we look for a generating function with: \begin{equation}\label{HJ Equation} \mathcal{H}\left(q_i,\frac{\partial S}{\partial q_i},t\right)+\frac{\partial S}{\partial t}=0 \end{equation} This is the Hamilton-Jacobi Equation.</p> <h2>II. Kepler's Laws</h2> <h3>II.I Newton's Law and Polar Coordinates</h3> <p>We consider two bodies of mass \(m_0'\) and \(m_1'\). Newton’s law of gravitation can be written: \begin{equation} \ddot{\vec{r}}_0’=\frac{\mathcal{G}m_1’}{\parallel \vec{r}_1’-\vec{r}_0’\parallel^3}\left(\vec{r}_1’-\vec{r}_0’\right) \end{equation} \begin{equation} \ddot{\vec{r}}_1’=-\frac{\mathcal{G}m_0’}{\parallel \vec{r}_1’-\vec{r}_0’\parallel^3}\left(\vec{r}_1’-\vec{r}_0’\right) \end{equation} Defining \(\vec{r}=\vec{r}_1'-\vec{r}_0'\), we find: \begin{equation} \label{governing Newton Law} \ddot{\vec{r}} = -\frac{\mathcal{G}m}{\parallel \vec{r}\parallel^3}\vec{r} \end{equation} we have defined \(m\equiv m_0'+m_1'\).</p> <p>We rewrite \eqref{governing Newton Law} using polar coordinates, with the basis transformation: \begin{equation} <br> \hat{e}_x=\cos{f}\hat{e}_r-\sin{f}\hat{e}_f \end{equation}</p> <p>\begin{equation} \hat{e}_f=\sin{f}\hat{e}_r+\cos{f}\hat{e}_f \end{equation} It is not difficult to demonstrate: \begin{equation} \vec{r}=r\hat{e}_e \end{equation}</p> <p>\begin{equation} \vec{\dot{r}}=\dot{r}\hat{e}_r+r\dot{f}\hat{e}_f \end{equation}</p> <p>\begin{equation} \vec{\ddot{r}}=(\ddot{r}-{r}\dot{f}^2){\hat{e}_r}+(2\dot{r} \dot{f} + r \ddot{f})\hat{e}_f \end{equation} \eqref{governing Newton Law} becomes: \begin{equation}\label{Netwon polar coordinates} (\ddot{r}-{r}\dot{f}^2){\hat{e}_r}+(2\dot{r} \dot{f} + r \ddot{f})\hat{e}_f = -\frac{\mathcal{G}m}{r^2}\hat{e}_r \end{equation} The norm of the angular momentum vector is given by \(\parallel\vec{r}\times\dot{\vec{r}}\parallel= r^2\dot{f}\). From \eqref{Netwon polar coordinates}, \(\frac{d\left(r^2\dot{f}\right)}{dt}=0\), a statement of the conservation of total angular momentum. Let us define the reduced mass: \(\mu\equiv\frac{m_0'm_1'}{m_0'+m_1'}\), and defined the quantity \(L\equiv\mu\parallel\vec{r}\times\dot{\vec{r}}\parallel=\mu r^2\dot{f}\).</p> <h3>II.II Kepler's First Law</h3> <p>We rewrite \eqref{Netwon polar coordinates} in the \(\hat{e}_r\) direction:</p> <p>\begin{equation}\label{r equation newton} \ddot{r}-\frac{L^2}{\mu^2r^3}=-\frac{\mathcal{G}m}{r^2} \end{equation}</p> <p>Performing the substitution, \(u=\frac{1}{r}\):</p> <p>\begin{equation} \dot{r} = \dot{u}\frac{dr}{du} = -r^2\dot{u} = -r^2\dot{f}\frac{du}{df} = -\frac{L}{\mu}\frac{du}{df} \end{equation}</p> <p>\begin{equation} \ddot{r} = \frac{d}{dt}\left(-\frac{L}{\mu}\frac{du}{df}\right)=–\frac{L}{\mu}\dot{f}\frac{d^2u}{df^2} = -\left(\frac{L}{\mu}\right)^2u^2\frac{d^2u}{df^2} \end{equation}</p> <p>\eqref{Netwon polar coordinates} in terms of \(u\):</p> <p>\begin{equation} \label{dif eq with u} -\left(\frac{L}{\mu}\right)^2u^2\frac{d^2u}{df^2} -\frac{L^2}{\mu^2r^3} = -\mathcal{G}mu^2 \rightarrow \frac{d^2u}{df^2} + u = \mathcal{G}m\frac{\mu^2}{L^2} \end{equation}</p> <p>Solving for \(u\):</p> <p>\begin{equation} u=\mathcal{G}m\frac{\mu^2}{L^2}\left(1+e\cos{f}\right) \end{equation}</p> <p>Where \(e\) is a dimensionless parameter, the \textit{eccentricity} which we are free to set. Solving for \(r\):</p> <p>\begin{equation}\label{r equation kepler} r=\frac{L^2}{\mathcal{G}m\mu^2}\frac{1}{1+e\cos{f}} \end{equation}</p> <p>We consider only \(0&lt;e&lt;1\), giving a closed orbit. Broadly speaking, the closer \(e\) is to 0, the more circular an orbit is, and as \(e\) approaches 1, the orbit becomes more elliptical. This is Kepler’s First Law. Note that because \(e\) is a constant we chose, \(\dot{e}=0\).</p> <h3>II.III Kepler's Third Law</h3> <p>We relate the orbit period \(P\) with the orbit’s semi-major axis \(a\). Converting \eqref{r equation kepler} into Cartesian coordinates:</p> <p>\begin{equation} r+ex=\frac{L^2}{\mathcal{G}m\mu^2}\rightarrow y^2=\left(\frac{L^2}{\mathcal{G}m\mu^2}-ex\right)^2-x^2 \end{equation}</p> <p>We find the length \(l\), of the orbiting ellipse by adding the zeros of our ellipse:</p> <p>\begin{equation} l= \frac{L^2}{\mathcal{G}m\mu^2}\frac{1}{e+1} - \frac{L^2}{\mathcal{G}m\mu^2}\frac{1}{e-1} = \frac{2L^2}{\mathcal{G}m\mu^2}\frac{1}{1-e^2} \end{equation}</p> <p>The semi-major axis \(a\) is defined as half this length:</p> <p>\begin{equation}\label{a equation} a=\frac{L^2}{\mathcal{G}m\mu^2}\frac{1}{1-e^2} \end{equation}</p> <p>The height, \(h\), of our ellipse is given by the maximum of y:</p> <p>\begin{equation} h=\frac{L^2}{\mathcal{G}m\mu^2}\frac{1}{\sqrt{1-e^2}} \end{equation}</p> <p>Finding the area, \(A\), of the ellipse:</p> <p>\begin{equation} A=\pi\frac{lh}{2}=\pi\left(\frac{L^2}{\mathcal{G}m\mu^2}\right)^2\left({1-e^2}\right)^{-\frac{3}{2}}=\pi\sqrt{\frac{L^2}{\mathcal{G}m\mu^2}}a^{\frac{3}{2}} \end{equation}</p> <p>Using Kepler’s second law, which is easily found by considering the area swept out in our ellipse over time:</p> <p>\begin{equation} \dot{A} \simeq \frac{1}{2}r^2\dot{f} = \frac{L}{2\mu} \end{equation}</p> <p>We can find the period \(P\):</p> <p>\begin{equation} P=\frac{A}{\dot{A}}=\frac{2\pi a^{\frac{3}{2}}}{\sqrt{\mathcal{G}m}} \end{equation}</p> <p>We define the mean motion at \(n=\frac{2\pi}{P}\) and summarize Kepler’s Laws:</p> <p>\begin{equation} n=\sqrt{\frac{\mathcal{G}m}{a^3}}\label{n equation} \end{equation} \begin{equation} L=\mu\sqrt{\mathcal{G}ma\left(1-e^2\right)}=\mu na^2\sqrt{1-e^2}\label{L defintion} \end{equation} \begin{equation} r=\frac{a\left(1-e^2\right)}{1+e\cos{f}}\label{r theta equation} \end{equation}</p> <h2>III. Orbital Elements</h2> <h3>III.I Derivation of Mean and Eccentric Anomalies</h3> <p>From \eqref{r theta equation}:</p> <p>\begin{equation} \dot{r} = \frac{r}{1+e\cos{f}}e\sin{f}\dot{f}=\frac{L}{\mu r\left(1+e\cos{f}\right)}e\sin{f}=\frac{na^2\sqrt{1-e^2}}{r\left(1+e\cos{f}\right)}e\sin{f} \end{equation}</p> <p>We have used \(L=\mu r^2\dot{f}\) and \eqref{L defintion}. Again using \eqref{r theta equation}:</p> <p>\begin{equation} \dot{r} = \frac{na}{\sqrt{1-e^2}}e\sin{f} \end{equation}</p> <p>In polar coordinates, the magnitude of the velocity vector \(\parallel\dot{\vec{r}}\parallel^2=\parallel\vec{v}\parallel^2=\dot{r}^2+r^2\dot{f}^2\), resulting in:</p> <p>\begin{equation} v^2=\dot{r}^2+\frac{L^2}{r^2\mu^2}=\frac{n^2a^2}{1-e^2}e^2\sin^2{f}+\frac{n^2a^2}{1-e^2}\left(1+e\cos{f}\right)^2=\frac{n^2a^2}{1-e^2}\left(1+2e\cos{f}+e^2\right) \end{equation}</p> <p>With \eqref{r theta equation} and \eqref{n equation}:</p> <p>\begin{equation}\label{v^2 equation} v^2=\frac{n^2a^2}{1-e^2}\left(\frac{2a(1-e^2)}{r}-1+e^2\right)=\frac{2n^2a^3}{r}-n^2a^2=\mathcal{G}m\left(\frac{2}{r}-\frac{1}{a}\right) \end{equation}</p> <p>Using \eqref{v^2 equation} to rewrite \(\dot{r}\):</p> <p>\begin{equation}\label{r dot equation} \dot{r}^2=v^2-\frac{L^2}{r^2\mu^2}=\frac{2n^2a^3}{r}-n^2a^2-\frac{ n^2a^4\left(1-e^2\right)}{r^2}\rightarrow \dot{r}=\frac{na}{r}\sqrt{a^2e^2-\left(r-a\right)^2} \end{equation}</p> <p>We have a differential equation for \(r\), which we solve by writing \(r\) in terms of the eccentric anomaly \(E\):</p> <p>\begin{equation} r=a\left(1-e\cos{E}\right)\label{r E equation}\end{equation} \begin{equation} \dot{r}=ae\sin{E}\dot{E} \end{equation}</p> <p>Rewriting \eqref{r dot equation} using \(E\):</p> <p>\begin{equation} \dot{E}=\frac{na}{r}=\frac{n}{1-e\cos{E}} \end{equation}</p> <p>Integrating, we find:</p> <p>\begin{equation}\label{Kepler eq} E-e\sin{E}=n\left(t-t_0\right)\equiv\mathcal{M} \end{equation}</p> <p>This is Kepler’s Equation, where \(\mathcal{M}\) is known as the mean anomaly.</p> <h3>III.II Two-Dimensional Orbital Elliptical Elements</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Figures_Cmech_Notes/Orbital_Element_diagram_v2-480.webp 480w,/assets/img/Figures_Cmech_Notes/Orbital_Element_diagram_v2-800.webp 800w,/assets/img/Figures_Cmech_Notes/Orbital_Element_diagram_v2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Figures_Cmech_Notes/Orbital_Element_diagram_v2.png" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="Orbital element diagram" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Orbital elements, definition of \(a\), \(e\), \(E\), and \(f\).</p> <p>From our orbital element diagram, we can immediately conclude: \begin{equation}\label{cos f equation} q_1=r\cos{f}=a\cos{E}-ae \end{equation} From \eqref{r theta equation}: \begin{equation} r=\frac{a(1-e^2)}{1+e\cos{f}}=\frac{ra(1-e^2)}{r+eq_1}=\frac{ra(1-e^2)}{r+e\left(a\cos{E}-ae\right)} \end{equation} \begin{equation} \rightarrow r=a(1-e^2)-e\left(a\cos{E}-ae\right)=a\left(1-e\cos{E}\right) \end{equation} Aligning with our result of \eqref{r E equation}. We can also calculate \(q_2\): \begin{equation} q_2=\sqrt{r^2-q_1^2}= a\sqrt{\left(1-e\cos{E} \right)^2 - \left(\cos{E}-e \right)^2} = a\sqrt{1-e^2}\sin{E} \end{equation} In summary: \begin{equation} q_1=a\left(\cos{E}-e\right)\label{q_1 eq} \end{equation} \begin{equation} q_2=a\sqrt{1-e^2}\sin{E}\label{q_2 eq} \end{equation} \begin{equation} r=a\left(1-e\cos{E}\right) \end{equation}</p> <h3>III.III Three-Dimensional Orbital Elements</h3> <p>To characterize the orientation of our ellipse in three-dimensional space with respect to a reference plane \(x,y,z\), we introduce three new angles. The first is the inclination \(i\), describing the tilt of the orbiting ellipse with respect to the \(x,y\) plane. Any orbit with a nonzero inclination will intersect the reference plane at two points. The \textit{ascending node} is the point at which the body passes from negative \(z\) to positive \(z\), and the \textit{descending node} is the opposite. The angle between the \textit{ascending node} with the \(x\) axis is the longitude of the ascending node, noted by \(\Omega\). Finally, \(\omega\), the argument of the pericentre determines the angle from the \(x,y\) of the pericentre along the orbiting plane.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Figures_Cmech_Notes/Orbital_3d_elemenets_v2-480.webp 480w,/assets/img/Figures_Cmech_Notes/Orbital_3d_elemenets_v2-800.webp 800w,/assets/img/Figures_Cmech_Notes/Orbital_3d_elemenets_v2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Figures_Cmech_Notes/Orbital_3d_elemenets_v2.png" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="Orbital element diagram 3d" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Three-dimensional orbital angles.</p> <p>Schematically, the transformation from a vector \(\vec{r}\) in the reference plane to a vector \(\vec{q}\) in the orbiting ellipse can be thought of as three consecutive rotations. First, we rotate around the \(z\) axis by \(\Omega\) to align the \(x\) axis with the ascending node. Then we rotate around the \(x\) axis by \(I\) to set the \(z\) axis normal to the orbiting plane. Lastly, we rotate around the \(z\) axis by \(\omega\) to set the \(x\) axis along the semi-minor axis. In summary, we define the rotation:</p> <p>\begin{equation} \begin{pmatrix} x <br> y <br> z <br> \end{pmatrix} = \begin{pmatrix} \cos{\Omega} &amp; -\sin{\Omega} &amp; 0<br> \sin{\Omega} &amp; \cos{\Omega} &amp; 0<br> 0 &amp; 0 &amp; 1 <br> \end{pmatrix} <br> \begin{pmatrix} 1 &amp; 0 &amp; 0<br> 0 &amp; \cos{I} &amp; -\sin{I}<br> 0 &amp; \sin{I} &amp; \cos{I}<br> \end{pmatrix}<br> \begin{pmatrix} \cos{\omega} &amp; -\sin{\omega} &amp; 0<br> \sin{\omega} &amp; \cos{\omega} &amp; 0<br> 0 &amp; 0 &amp; 1 <br> \end{pmatrix}<br> \begin{pmatrix} q_1 <br> q_2 <br> q_3 <br> \end{pmatrix} \end{equation}</p> <p>\begin{equation} \vec{r}=\bf{R}<em>\Omega \bf{R}</em>{I} \bf{R}<em>{\omega} = \bf{R}</em>{xq}\vec{q} \end{equation}</p> <p>The matrix \(\bm{R}_{xq}\) transforms \(\vec{q}\) to \(\vec{r}\) and \(\bm{R}_{qx} =\bm{R}_{xq}^{-1}\) does the inverse. \begin{equation} \bm{R}_{xq}= <br> \begin{pmatrix} \cos{\Omega}\cos{\omega}-\sin{\Omega}\cos{I}\sin{\omega} &amp; -\cos{\Omega}\sin{\omega}-\sin{\Omega}\cos{I}\cos{\omega} &amp; \sin{\Omega}\sin{I}<br> \sin{\Omega}\cos{\omega}+\cos{\Omega}\cos{I}\sin{\omega} &amp; -\sin{\Omega}\sin{\omega}+\cos{\Omega}\cos{I}\cos{\omega} &amp; -\cos{\Omega}\sin{I}<br> \sin{I}\sin{\omega} &amp; \sin{I}\cos{\omega} &amp; \cos{I} <br> \end{pmatrix}<br> \end{equation} From \eqref{q_1 eq} and \eqref{q_2 eq}, and because the orbit is by definition in the orbiting ellipse setting \(q_3=0\): \begin{equation} \vec{q}= \begin{pmatrix} a\left(\cos{E}-e\right)<br> a\sqrt{1-e^2}\sin{E}<br> 0 <br> \end{pmatrix} \end{equation} Utilizing our transform and polar coordinates, \(q_1=r\cos{f}\), \(q_2=r\sin{f}\): \begin{equation} \frac{x}{r}=\left(\cos{\Omega}\cos{\omega}-\sin{\Omega}\cos{I}\sin{\omega}\right)\cos{f}+\left(-\cos{\Omega}\sin{\omega}-\sin{\Omega}\cos{I}\cos{\omega}\right)\sin{f}\nonumber \end{equation} \begin{equation} =\cos{\Omega}\cos{(\omega+f)}-\sin{\Omega}\cos{I}\sin{(\omega+f)}\label{x orbital elements} \end{equation} \begin{equation} \frac{y}{r}=\left(\sin{\Omega}\cos{\omega}+\cos{\Omega}\cos{I}\sin{\omega}\right)\cos{f}+\left(-\sin{\Omega}\sin{\omega}+\cos{\Omega}\cos{I}\cos{\omega}\right)\sin{f}\nonumber \end{equation} \begin{equation} =\sin{\Omega}\cos{(\omega+f)}+\sin{\Omega}\cos{I}\cos{(\omega+f)}\label{y orbital elements} \end{equation} \begin{equation} \frac{z}{r}=\sin{I}\sin{\omega}\cos{f}+\sin{I}\cos{\omega}\sin{f}\nonumber \end{equation} \begin{equation} =\sin{I}\sin{(\omega+f)}\label{z orbital elements} \end{equation}</p> <h2>IV. Expansion of the Two-Body Hamiltonian in Delaunay Variables}\label{Expansion of the Two-Body Hamiltonian in Delaunay Variables</h2> <p>Here we write the Hamiltonian for the two-body system and solve the Hamilton-Jacobi Equation to find a set of action-angle variables that are constant over time.</p> <p>We begin by identifying the Two-Body Hamiltonian in Cartesian coordinates. From \eqref{governing Newton Law}, the Lagrangian of the system is given by: \begin{equation} \mathcal{L}=\frac{1}{2}\mu\parallel\dot{\vec{r}}\parallel^2+\frac{\mathcal{G}\mu m}{\parallel\vec{r}\parallel} \end{equation} Via the Euler-Lagrange Equation, \eqref{governing Newton Law} is recovered: \begin{equation} \frac{d}{dt}\left(\frac{\partial \mathcal{L}}{\dot{\vec{r}}}\right)-\frac{\partial \mathcal{L}}{\vec{r}}=0\rightarrow\mu\ddot{\vec{r}}+\frac{\mathcal{G}\mu m}{\parallel\vec{r}\parallel^3}\vec{r}=0 \end{equation} We can now write the Hamiltonian using: \begin{equation \vec{p}=\frac{\partial \mathcal{L}}{\dot{\vec{r}}}=\mu\dot{\vec{r}}\label{p def} \end{equation} \begin{equation \mathcal{H}=p\dot{r}-\mathcal{L}=\frac{1}{2\mu}\parallel\vec{p}\parallel^2-\frac{\mathcal{G}\mu m}{\parallel\vec{r}\parallel} \end{equation} From the spherical symmetry of the problem, it is natural for us to proceed using spherical coordinates. We perform another canonical transform from \(p_x\), \(p_y\), \(p_z\), \(r_x\), \(r_y\), and \(r_z\) coordinates to \(p_r\), \(p_\phi\), \(p_\theta\), \(r\), \(\theta\), and \(\phi\) coordinates: \begin{equation} r_x = r \cos{\phi} \sin{\theta} \label{polar transform start} \end{equation}</p> <p>\begin{equation} r_y = r \sin{\phi} \sin{\theta} \end{equation}</p> <p>\begin{equation} r_z = r \cos{\theta} \end{equation}</p> <p>\begin{equation} p_x = p_r \cos{\phi} \sin{\theta} - \frac{p_\phi}{r \sin{\theta}} \sin{\phi} + \frac{p_\theta}{r} \cos{\phi} \cos{\theta} \end{equation}</p> <p>\begin{equation} p_y = p_r \sin{\phi} \sin{\theta} + \frac{p_\phi}{r \sin{\theta}} \cos{\phi} + \frac{p_\theta}{r} \sin{\phi} \cos{\theta} \end{equation}</p> <p>\begin{equation} p_z = p_r \cos{\theta} - \frac{p_\theta}{r} \sin{\theta} \end{equation}</p> <p>\begin{equation} p_r = \sqrt{p_x^2 + p_y^2 + p_z^2} \label{polar transform end} \end{equation}</p> <p>Again, it can be shown that this transform satisfies \eqref{cannonical 1}-\eqref{cannonical 3}. The Hamiltonian becomes: \begin{equation}\label{2 body cartesian hamiltonian} \mathcal{H}=\frac{1}{2\mu}\left(p_r^2+\frac{p_\theta^2}{r^2}+\frac{p_\phi^2}{r^2\sin^2{\theta}}\right)-\frac{\mathcal{G}\mu m}{r} \end{equation}</p> <h3>Action-Angle Variables</h3> <p>We now find a canonical transform, \(q_i\rightarrow Q_i\) and \(p_i\rightarrow P_i\) such that our transformed Hamiltonian \(\mathcal{K}\) is a function of only momenta, \(\mathcal{K}\left(P_i\right)\). Transformed position coordinates are known as <em>angles</em> and transformed momenta are known as <em>actions</em>.</p> <p>Utilizing the Hamilton-Jacobi Equation (\eqref{HJ Equation}) with a generating function \(S\left(r,\theta,\phi;P_1,P_2,P_3;t\right)\), where \(P_1\), \(P_2\), and \(P_3\) are constants of motion because the transformed Hamiltonian \(\mathcal{K}\) is independent of \(Q_i\). The Hamilton-Jacobi Equation is: \begin{equation} \frac{1}{2\mu}\left(\left(\frac{\partial S}{\partial r}\right)^2+\frac{1}{r^2}\left(\frac{\partial S}{\partial \theta}\right)^2+\frac{1}{r^2\sin^2{\theta}}\left(\frac{\partial S}{\partial \phi}\right)^2\right)-\frac{\mathcal{G}\mu m}{r}+\frac{\partial \partial S}{t}=0 \end{equation} Separating \(S\): \(S\left(r,\theta,\phi;P_1,P_2,P_3;t\right)=S_r\left(r;P_i\right)+S_\theta\left(\theta;P_i\right)+S_\phi\left(\phi;P_i\right)+S_t\left(P_i;t\right)\), we find: \begin{equation} \frac{1}{2\mu}\left(\left(\frac{dS_r}{dr}\right)^2+\frac{1}{r^2}\left(\frac{dS_\theta}{d\theta}\right)^2+\frac{1}{r^2\sin^2{\theta}}\left(\frac{dS_\phi}{d\phi}\right)^2\right)-\frac{\mathcal{G}\mu m}{r}+\frac{S_t}{dt}=0 \end{equation} We find: \begin{equation} \frac{dS_t}{dt} = -P_1 \label{S_t derivative} \end{equation}</p> <p>\begin{equation} \frac{dS_\phi}{d\phi} = P_2 \end{equation}</p> <p>\begin{equation} \left(\frac{dS_\theta}{d\theta}\right)^2 + \frac{P_2^2}{\sin^2\theta} = P_3^2 \end{equation}</p> <p>\begin{equation} \left(\frac{dS_r}{dr}\right)^2 + \frac{P_3}{r^2} - \frac{2\mathcal{G}\mu^2 m}{r} = 2\mu P_1 \label{S_r derivative} \end{equation}</p> <p>Now we identify the three constants of motion, \(P_1\), \(P_2\), and \(P_3\). As \(\frac{\partial \mathcal{H}}{\partial t}=0\), the energy of the system is conserved. \begin{equation} P_1=\frac{1}{2\mu}\left(p_r^2+\frac{p_\theta^2}{r^2}+\frac{p_\phi^2}{r^2\sin^2{\theta}}\right)-\frac{\mathcal{G}\mu m}{r} \end{equation} The total angular momentum of the system: \begin{equation} P_3^2=p_\theta^2+\frac{p_\phi^2}{\sin^2{\theta}} \end{equation} and the angular momentum along the \(z\) axis: \begin{equation} P_2=p_\phi \end{equation} are also conserved. It is not hard to show this conservation via \eqref{const function}. \(\[P_1,\mathcal{H}\]=0\), \(\[P_2^2,\mathcal{H}\]=0\), and \(\[P_3,\mathcal{H}\]=0\). It can also be shown that these variables are canonical (\eqref{cannonical 1}-\eqref{cannonical 3}): \(\[P_1,P_2^2\]=0\), \(\[P_1,P_3\]=0\), and \(\[P_2^2,P_3\]=0\).</p> <p>We use our previous results to expand \(P_1\), \(P_2\), and \(P_3\) into orbital elements. \(P_1\) is the total energy of the system: \begin{equation} P_1=\frac{\mu}{2}\parallel\dot{\vec{r}}\parallel^2-\frac{\mathcal{G}\mu m}{r}=\mathcal{G}\mu m\left(\frac{1}{r}-\frac{1}{2a}\right)-\frac{\mathcal{G}\mu m}{r}=-\frac{\mathcal{G}\mu m}{2a} \end{equation} We have used \eqref{p def} and \eqref{v^2 equation}. To transform \(P_2\) and \(P_3\), we need to consider the angular momentum of the system. Recalling that \(L\equiv\mu\parallel\vec{r}\times\dot{\vec{r}}\parallel\) and using \eqref{polar transform end}-\eqref{polar transform end}: \begin{equation} L\equiv\parallel\vec{r}\times{\vec{p}}\parallel=\sqrt{p_\theta^2+\frac{p_\phi^2}{\sin^2{\theta}}}\rightarrow P_3=L \end{equation} Considering the \(z\) component of the angular momentum yields: \begin{equation} \left(\vec{r}\times\dot{\vec{r}}\right)<em>z=p</em>\phi=P_2 \end{equation} As \(L\) is the norm of the angular momentum, and the angular momentum of the system is normal to the orbital plane, the \(z\) component of the angular momentum is given by \(P_3=L\cos{I}\), a projection of the angular momentum onto the \(z\) axis. With \eqref{L defintion} in summary: \begin{align} P_1=-\frac{\mathcal{G}\mu m}{2a}\label{P_1 def}<br> P_3=\mu\sqrt{\mathcal{G}ma\left(1-e^2\right)}\label{P_3 def}<br> P_2=P_3\cos{I}\label{P_2 def} \end{align}</p> <p>Having expressed our transformed momenta in orbital elements, we must do the same for our transformed position coordinates. We solve for \(S\) by integrating \eqref{S_t derivative}-\eqref{S_r derivative}: \begin{equation} S=-P_1t+P_2\phi+\int\sqrt{P_3^2-\frac{P_2^2}{\sin^2\theta}}d\theta+\int\sqrt{2\mu P_1+\frac{2\mathcal{G}\mu^2 m}{r}-\frac{P_3^2}{r^2}}dr \end{equation} Using \eqref{transormned position coordinates}: \begin{align} Q_1=\pdv{S}{P_1}=-t+\mu\int\frac{dr}{\sqrt{2\mu\left(P_1+\frac{\mathcal{G}\mu m}{r}\right)-\frac{P_3^2}{r^2}}}=-t+\mu I_1<br> Q_2=\pdv{S}{P_2}=\phi-P_2\int\frac{d\theta}{\sin^2\theta\sqrt{P_3^2-\frac{P_2^2}{\sin^2\theta}}}=\phi-P_2I_3\ <br> Q_3=\pdv{S}{P_3}=P_3\int\frac{d\theta}{\sqrt{P_3^2-\frac{P_2^2}{\sin^2\theta}}}-P_3\int\frac{dr}{r^2\sqrt{2\mu\left(P_1+\frac{\mathcal{G}\mu m}{r}\right)-\frac{P_3^2}{r^2}}}=P_3\left(I_4-I_2\right) \end{align} Evaluating the integrals in order, starting with \(I_1\). With \eqref{P_1 def} and \eqref{P_3 def}: \begin{equation} I_1=\frac{1}{\mu\sqrt{\mathcal{G}m}}\int\frac{rdr}{\sqrt{-\frac{r^2}{a}+2r-a\left(1-e^2\right)}} \end{equation} With \eqref{r E equation}, \(dr=ae\sin EdE\), and \(I_1\) becomes: \begin{align<em>} I_1=\frac{1}{\mu\sqrt{\mathcal{G}m}}\int\frac{a^2e\left(1-e\cos E\right)\sin EdE}{\sqrt{-{a\left(1-e\cos E\right)^2}+2a\left(1-e\cos E\right)-a\left(1-e^2\right)}}<br> =\frac{a^\frac{3}{2}}{\mu\sqrt{\mathcal{G}m}}\int\left(1-e\cos E\right)dE \end{align</em>} Solving and plugging in \eqref{Kepler eq} \begin{equation} I_1=\frac{a^\frac{3}{2}}{\mu\sqrt{\mathcal{G}m}}\left(E-e\sin E\right)=\frac{\mathcal{M}}{\mu n} \end{equation} Now for \(I_2\), with the same substitutions: \begin{align<em>} I_2=\frac{1}{\mu\sqrt{\mathcal{G}m}}\int\frac{dr}{r\sqrt{-\frac{r^2}{a}+2r-a\left(1-e^2\right)}}<br> =\frac{1}{\mu\sqrt{\mathcal{G}m}}\int\frac{e\sin EdE}{\left(1-e\cos{E}\right)\sqrt{-{a\left(1-e\cos E\right)^2}+2a\left(1-e\cos E\right)-a\left(1-e^2\right)}}<br> =\frac{1}{\mu\sqrt{\mathcal{G}ma}}\int\frac{dE}{1-e\cos{E}}<br> \end{align</em>} Now, with \eqref{cos f equation}: \begin{align} \cos{f}=\frac{a}{r}\left(\cos{E}-e\right)=\frac{\cos{E}-e}{1-e\cos E}<br> \sin{f}=\sqrt{1-\cos^2 f}=\sqrt{1-e^2}\frac{\sin E}{1-e\cos E}<br> -\sin fdf=\frac{\left(e^2-1\right)\sin E}{\left(1-e\cos E\right)^2}dE\rightarrow df= \frac{\sqrt{1-e^2}}{1-e\cos E}dE<br> \end{align} Thus, \(I_2\) becomes: \begin{equation} I_2=\frac{1}{\mu\sqrt{\mathcal{G}ma\left(1-e^2\right)}}\int df=\frac{f}{P_3} \end{equation} Now for \(I_3\). With \eqref{P_2 def} and \eqref{P_3 def}: \begin{equation} I_3=\frac{1}{P_2}\int\frac{\cos Id\theta}{\sin^2\theta\sqrt{1-\frac{\cos^2 I}{\sin^2\theta}}} \end{equation} To proceed, we must consult spherical trigonometric relationships. In \eqref{spherical trig fig}, we plot the angle created by the body’s position on the orbital plane and the reference plane. Because \(\theta\) is measured from the \(z\) axis towards the reference plane, we must invert \(I\).</p> </article> <h2>References</h2> <div class="publications"> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Teo A. Lara. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>